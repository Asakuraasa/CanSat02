---想定使用用途---
Xbeeを使った通信はキャリアや円筒などに入れた際、途切れずに通信できるか調べる
着地した際の加速度値を求め、プログラムに反映させる

---主な機能---
9軸の加速度の値、加速度を積分した速度の値、地上局から受け取った値をcsvファイルに記入する。
地上局に「OK」という文字列を送信する。

DropTest.pngにこのプログラムのフローチャートが書いてある
注意）照度センサについてのプログラムは全てコメントアウトしてある。照度センサについてはコメントアウトを解除して使う


---使用方法---
１，DropTest.pyをいれたラズベリーパイに9軸センサとXbeeを接続し、落下させたい物体に固定する。
２，ラズパイとデータを受け取るパソコンを同じWi-Fiに繋ぎ、ssh接続を行う。
３，ラズパイとssh接続を行ったパソコンを使い、Tera TermやコマンドプロンプトなどでDropTest.pyを実行する。
４，XCTUからラズパイに向けて任意の値を送信する。
５，ラズパイから「OK」という値が送られているか確認する
６，ctrl+cでプログラムを終了させる。
７，DropTest.pyが入っているディレクトリにcsvファイルが作られるので、時刻、x軸・y軸・z軸の加速度と速度、PCから受信した値を確認する。


プログラム以外の実行手順を含めたものは以下のサイトを参考にする
https://tdumedia.sharepoint.com/sites/astronomy?e=1%3Ab9c893ef34ae44f183c59b8d1de73116
↑ホームに飛ばされます。書いたらそれが正しいリンクか確認してください。


---I2Cアドレス---
I2Cアドレスは以下のように設定した。I2C通信を使用するセンサで同じアドレスのものがある場合は変更する

9軸センサについて
＊9軸センサの表面についてる半田ジャンパ、J1とJ2ははんだづけを行わない（アドレスが変わるため）
addressG = 0x6a
addressA = 0x6a
addressM = 0x1c

照度センサについて
dev_addr = 0x39


---ピン番号---
9軸センサの表面についてる半田ジャンパについて
J1　：　はんだ付けしない
J2　：　はんだ付けしない

センサ側（9軸センサ）：ラズパイ側
V+　：　3.3V
GND　：　GND
SDA　：　gpio2
SCL　：　gpio3

センサ側（照度センサ）　：　ラズパイ側
SCL　：　gpio3
SDA　：　gpio2
INT　：接続しない
OE　：　接続しない
3V3　：　3.3V
GND　：　GND
VIN　：　3.3V

機器側（Xbee）：ラズパイ側
microUSB端子　：　タイプA端子


---必須ライブラリ---
import csvについて
#csv形式で出力する
→おそらく標準で使用できるはずです。コマンドでインストールする必要はない

import serialについて
pip3 install pyserial　を実行することでpyserialがインストールできる。

import smbusについて
#ダウンロードする9軸を動かすためのライブラリを使用するには、sudo apt-get install python3-smbusを実行し、smbusをインストールする必要があります。
また、sudo raspi-configから、Interface Optionを選択し、I2Cから、「はい」または「Yes」をEnterで確定して、I2C通信を有効にする必要があります。
※確定後の再起動は必要ありません。

この手順に関するヘルプは
https://www.y2c.co.jp/i2c-r/raspberrypi/i2c-enable/
を参照してください。

sudo nano /etc/rc.localを実行し、エディターを開きます。
python NineAxisSensor.pyとexit0よりも前に記載し、保存して確定します。
次回から、起動時にpythonが実行されるようになります。
※この方法では、Pythonはroot権限で実行されます。
困ることがある場合は他の方法を参照してください。


---参考にしたサイト---
9軸センサ
https://ja.stackoverflow.com/questions/40783/i2c-raspberrypi%E3%81%AB%E6%8E%A5%E7%B6%9A%E3%81%97%E3%81%9F9%E8%BB%B8%E6%85%A3%E6%80%A7%E3%82%BB%E3%83%B3%E3%82%B5%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E3%81%94%E6%95%99%E7%A4%BA%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84
https://garchiving.com/how-to-bmx055-with-sample/

照度センサ
https://s-design-tokyo.com/use-tsl25721/

---９軸センサー　LSM9DS1 ---
取扱説明書
chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://akizukidenshi.com/download/ds/akizuki/AE-LSM9DS1.pdf
秋月のリンク
https://akizukidenshi.com/catalog/g/gM-15381/

---照度センサ　AE-TSL25721---
取扱説明書
chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://akizukidenshi.com/download/ds/akizuki/AE-TSL25721_20200806.pdf
秋月のリンク
https://akizukidenshi.com/catalog/g/gK-15536/

---無線機（Xbee）　XB24CZ7WIT-004---
秋月のリンク
https://akizukidenshi.com/catalog/g/gM-10072/
